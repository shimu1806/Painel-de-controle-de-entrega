{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de controle de Entrega</title>
    <link rel="stylesheet" href="{% static 'css/extends.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
    <body>


        <article class="container-main">
            <!-- container mural -->
            <section class="container-base">
                
                <!-- Contegem dos Status e checkbox filter -->

                <div class="container-mural" id="status-container">

                    <div id="boxes" class="box1">
                        <img src="../../static/src/image.png">
                    </div>
                    <div id="boxes" class="box2">
                        <h4>NÃO INICIADO</h4>
                        <p></p>
                        <input type="checkbox" id="checkbox2">
                    </div>
                    <div id="boxes" class="box3">
                        <h4>EM ANDAMENTO</h4>
                        <p></p>
                        <input type="checkbox" id="checkbox3">
                    </div>
                    <div id="boxes" class="box4">
                        <h4>FINALIZADO</h4>
                        <p></p>
                        <input type="checkbox" id="checkbox4">
                    </div>
                    <div id="boxes" class="box5">
                        <h4>PAUSA</h4>
                        <p></p>
                        <input type="checkbox" id="checkbox5">
                    </div>
                    <div id="boxes" class="box6">
                        <h4>DIVERGÊNCIA</h4>
                        <p></p>
                        <input type="checkbox" id="checkbox6">
                    </div>
                </div>
                <!-- endstatus -->
                
                <!-- container tabela -->
                <div class="table-responsive-sm">
                    <table class="table table-dark table-hover">
                        <thead class="table table-dark">
                            <tr>
                                <td onclick="filterTable(0)">STATUS</td>
                                <td onclick="filterTable(1)">FILIAL</td>
                                <td onclick="filterTable(2)">ORDEM</td>
                                <td onclick="filterTable(3)">PEDIDO</td>
                                <td onclick="filterTable(4)">CLIENT</td>
                                <td onclick="filterTable(5)">LOJA</td>
                                <td onclick="filterTable(6)">NOME</td>
                                <td onclick="filterTable(7)">DTEMIS</td>    
                                <td onclick="filterTable(8)">HREMIS</td>
                                <td onclick="filterTable(9)">DTINIS</td>
                                <td onclick="filterTable(10)">HRINIS</td>
                                <td onclick="filterTable(11)">DTFIMS</td>
                                <td onclick="filterTable(12)">HRFIMS</td>
                                <td onclick="filterTable(13)">NOTA</td>
                                <td onclick="filterTable(14)">SERIE</td>
                                <td onclick="filterTable(15)">PROD</td>
                                <td onclick="filterTable(16)">DESC</td>
                            </tr>
                        </thead>

                        <tbody class="table-group-divider">
                            <tr class="table table-dark table-borderless" id="pagination"></tr>
                        </tbody>

                    </table>
                    <!-- endtabela -->
                </div> 
            </section>
        </article>
        <!-- endcontainer mural -->               


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="{% static 'javascript/index.js' %}"></script>
    <script>
        

    function fetchTableData() {
        fetch('http://127.0.0.1:8000/fetch_data/')
        .then(response => response.json())
        .then(data => {
            const tableBody = document.querySelector('.table-group-divider');
            data.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><span class="status-${item.CB7_STATUS}"></span></td>
                    <td>${item.CB7_FILIAL}</td>
                    <td>${item.CB7_ORDSEP}</td>
                    <td>${item.CB7_PEDIDO}</td>
                    <td>${item.CB7_CLIENT}</td>
                    <td>${item.CB7_LOJA}</td>
                    <td>${item.A1_NOME}</td>
                    <td>${item.CB7_DTEMIS}</td>
                    <td>${item.CB7_HREMIS}</td>
                    <td>${item.CB7_DTINIS}</td>
                    <td>${item.CB7_HRINIS}</td>
                    <td>${item.CB7_DTFIMS}</td>
                    <td>${item.CB7_HRFIMS}</td>
                    <td>${item.CB7_NOTA}</td>
                    <td>${item.CB7_SERIE}</td>
                    <td>${item.CB8_PROD}</td>
                    <td>${item.B1_DESC}</td>
                `;
                tableBody.appendChild(row);
                    });
                })
            .catch(error => console.error('Error:', error));
        }

        fetchTableData();
        setInterval(fetchTableData, 10000);
        

    </script>
</body>
</html>